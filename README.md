# networkStorage
Training project network storage.
Вопрос:	Как организовать клиент-серверное взаимодействие?
Ответ:
	Взаимодействие клиента с программным интерфейсом приложения основано
	на использовании архитектурного стиля Representational State Transfer
	(сокращено REST). Обращение клиента за информацией на сервер с
	помощью	HTTP-запросов. Получаемая информация в формате JSON, XML, HTML.

Вопрос: Как и в каком виде передавать файлы?
	По байтам например используя BufferedInputStream, FileOutputStream.
Ответ: 

Вопрос: Как пересылать большие файлы?
Ответ: 
	Используем netty. ExecutionHandler предоставляет механизм для асинхронных
	задач обработки.

Вопрос: Как пересылать служебные команды?
Ответ:
	Для манипулирования ресурсами используем стандартные HTTP методы.
	Которые будем передавать в виде строк.
	GET 	Получения текущего представления ресурсов.
	POST 	Создания новых ресурсов.
	PATCH	Полное или частичное обновления существующих ресурсов.
	PUT	Создания нового ресурса или обновления существующего.
		Если ресурс с заданным идентификатором найден, информация о
		нём должна быть обновлена, в ином случае будет создан новый ресурс.
	DELETE	Удаление существующих ресурсов.

Вопрос: Что хранить в базе данных?
Ответ:
Сделал набросок будующей базы данных, не факт что все реализую. 
Таблица user:
	Регистрационные данные всех пользователей.
	Хеширование пароля алгоритмом SHA256. Адрес электронной почты
	для отправки нового пароля пользователю при сбросе пароля.
	id(bigint)		Идентификатор пользователя.
	version(bigint)		Версия.
	date_created(timestamp)	Дата регистрации.
	date_modified(timestamp)Дата последнего изменения.
	email(varchar)		Адрес электронной почты.
	password(varchar)	Хеш пароля.
	first_name(varchar)	Имя.
	last_name(varchar)	Фамилия.
Таблица role:
	Роли назначаемые пользователям, один пользователь может иметь
	несколько ролей.
	id(bigint)		Идентификатор роли.
	name(varchar)		Имя роли.
Таблица users_roles
	Отношение пользователей и ролей.
	user_id(bigint)		Идентификатор пользователя.
	role_id(bigint)		Идентификатор роли.
Таблица folder:
	Метаданные пользовательских папок. Каждая папка принадлежит одному
	владельцу, имеет родительскую папку и может содержать несколько
	вложенных папок.
	id(bigint)		Идентификатор папки.
	version(bigint)		Версия.
	date_created(timestamp)	Дата создания.
	data_modified(timestamp)Дата изменения.
	name(varchar)		Имя.
	root(boolean)		Флаг, указывающий на корневую папку.
	parent_id(bigint)	Идентификатор родительской папки.
	owner_id(bigint)	Идентификатор владельца.
Таблица files:
	id(bigint)		Идентификатор файла.
	version(bigint)		Версия.
	date_created(timestamp)	Дата загрузки.
	date_modified(timestamp)Дата последнего изменения.
	name(varchar)		Имя.
	size(bigint)		Размер в байтах.
	mime_type(varchar)	MIME-тип файла.
	location(varchar)	Путь к файлу.
	parent_id(bigint)	Идентификатор родительской папки.
	owner_id(bigint)	Идентификатор владельца.
Таблица property:
	Содержит свойства файла - дополнительные метаданные добавленные пользователем.
	Каждое поле key (ключ) и value (значение). у файла может быть только
	одно свойство с заданным ключом.
	id(bigint)			Идентификатор свойства.
	version(bigint)			Версия.
	date_created(timestamp)		Дата загрузки.
	date_modified(timestamp)	Дата последнего изменения.
	key(varchar)			Ключ.
	value(varchar)			Значение.
	file_id(bigint)			Идентификатор файла.

Вопрос: Как передавать структуру каталогов/файлов?
Ответ:
	Предположительно папки, создаваемые пользователями будут существовать только
	в базе данных в видле строки в таблице. Файлы на сервере хранятся
	в собственной иерархии папок файловой системы.
	Когда файл загружается на сервер, ему присваивается идентификатор UUID
	это уникальный 128-битный номер.На основе этого идентификатора генерируем
	уникальный путь к файлу. Из UUID извлекаются три первые пары символов
	и используются в качестве имён папок, каждая последующая из которых
	вложена в предыдущую. Сам идентификатор становится именем файла.
	Содержимое файла копируются на жёсткий диск по этому пути, а все
	метаданные, включая его настоящее имя и путь к файлу,сохраняются в базу данных.

Вопрос: Какую библиотеку использовать для сетевого взаимодействия: java.io, java.nio, Netty?
Ответ:
	Используем Netty - в его основе лежат java.io и java.nio.
	Это серверный асинхронный неблокирующий	событийно-ориентированный
	фреймворк для работы с сетью, предоставляющий простые безопасные
	элементы управления.
